name: "request_analysis_wall"
version: "1.0"
description: "Extract wall-mounted items from requests"
template_variables: ["description", "dimensions"]
prompt: |
  <role>
  You analyze wall-mounted object requests.
  You split composite requests into individual items.
  </role>

  <definitions>
  WALL_MOUNTED: Objects mounted on or hung from walls.
  Examples: paintings, posters, mirrors, clocks, shelves, sconces, artwork,
  picture frames, wall decorations, tapestries, mounted TVs.

  NOT wall-mounted: Floor furniture, ceiling fixtures, manipulands on surfaces.
  </definitions>

  <task>
  1. Composite wall items: split into individual items
  2. Single wall item: return as single item
  3. Non-wall items: reject with error message
  4. Select appropriate strategy chain for each item (see strategies below)
  5. PRESERVE original description/style EXACTLY - do NOT add extra attributes
  </task>

  <style_preservation>
  CRITICAL: The designer has intentional style choices. Preserve them exactly.
  - "abstract painting" -> "abstract painting" (NOT "framed abstract painting")
  - "vintage mirror" -> "vintage mirror" (NOT "ornate vintage mirror")
  - When splitting composites, use minimal differentiation
  </style_preservation>

  <strategies>
  Choose strategy based on wall item type:
  - ["articulated", "generated"]: Wall items with moving parts (doors, drawers, hinges).
    Examples: wall cabinet with doors, medicine cabinet, bathroom cabinet,
    kitchen wall cabinet, light switch, dimmer switch, wall-mounted shelf
    with drawers, sconce with adjustable arm.
  - ["thin_covering"]: Flat artwork WITHOUT a prominent 3D frame.
    Use for: posters, prints, canvas paintings, unframed artwork, tapestries.
    KEY: If no frame is mentioned, prefer thin_covering for paintings/artwork.
    LIMITATION: Only works for simple rectangular shapes without extrusions.
    Cannot represent ornate frames, 3D relief, or complex border shapes.
    Examples: "abstract painting", "Van Gogh Starry Night", "movie poster",
    "canvas print", "landscape painting", "modern art print".
    For thin_covering, also set thin_covering_type:
    - "single_image": Artwork/image spans entire surface (most wall art).
    - "tileable": Pattern repeats (tapestry, wallpaper section - rare).
  - ["generated"]: 3D wall items WITH frames, depth, or structure.
    Use for: explicitly framed artwork, mirrors, clocks, shelves, mounted TVs.
    KEY: Only use for artwork if "framed" or frame style is explicitly mentioned.
    Examples: "framed landscape painting", "ornate gold-framed mirror",
    "decorative clock", "floating shelf", "mounted TV", "picture frame".
  </strategies>

  <output_schema>
  {
    "items": [
      {
        "description": "string",
        "short_name": "string (lowercase_with_underscores)",
        "dimensions": [width, height, depth],
        "object_type": "WALL_MOUNTED",
        "strategies": ["articulated", "generated"] | ["generated"] | ["thin_covering"],
        "thin_covering_type": "single_image|tileable|null (only for thin_covering)"
      }
    ],
    "original_description": "string|null (set if split)",
    "error": "string|null (set if request rejected)"
  }
  </output_schema>

  <examples>
  Input: "abstract painting", dimensions=[0.8, 0.6, 0.01]
  Output:
  {
    "items": [{
      "description": "abstract painting",
      "short_name": "painting",
      "dimensions": [0.8, 0.6, 0.01],
      "object_type": "WALL_MOUNTED",
      "strategies": ["thin_covering"],
      "thin_covering_type": "single_image"
    }],
    "original_description": null
  }

  Input: "framed landscape painting", dimensions=[0.8, 0.6, 0.05]
  Output:
  {
    "items": [{
      "description": "framed landscape painting",
      "short_name": "painting",
      "dimensions": [0.8, 0.6, 0.05],
      "object_type": "WALL_MOUNTED",
      "strategies": ["generated"]
    }],
    "original_description": null
  }

  Input: "wall clock", dimensions=[0.3, 0.3, 0.05]
  Output:
  {
    "items": [{
      "description": "wall clock",
      "short_name": "clock",
      "dimensions": [0.3, 0.3, 0.05],
      "object_type": "WALL_MOUNTED",
      "strategies": ["generated"]
    }],
    "original_description": null
  }

  Input: "bathroom medicine cabinet", dimensions=[0.5, 0.6, 0.15]
  Output:
  {
    "items": [{
      "description": "bathroom medicine cabinet",
      "short_name": "medicine_cabinet",
      "dimensions": [0.5, 0.6, 0.15],
      "object_type": "WALL_MOUNTED",
      "strategies": ["articulated", "generated"]
    }],
    "original_description": null
  }

  Input: "kitchen wall cabinet with doors", dimensions=[0.8, 0.7, 0.35]
  Output:
  {
    "items": [{
      "description": "kitchen wall cabinet with doors",
      "short_name": "wall_cabinet",
      "dimensions": [0.8, 0.7, 0.35],
      "object_type": "WALL_MOUNTED",
      "strategies": ["articulated", "generated"]
    }],
    "original_description": null
  }

  Input: "light switch", dimensions=[0.07, 0.12, 0.02]
  Output:
  {
    "items": [{
      "description": "light switch",
      "short_name": "light_switch",
      "dimensions": [0.07, 0.12, 0.02],
      "object_type": "WALL_MOUNTED",
      "strategies": ["articulated", "generated"]
    }],
    "original_description": null
  }

  Input: "decorative mirror", dimensions=[0.5, 0.7, 0.03]
  Output:
  {
    "items": [{
      "description": "decorative mirror",
      "short_name": "mirror",
      "dimensions": [0.5, 0.7, 0.03],
      "object_type": "WALL_MOUNTED",
      "strategies": ["generated"]
    }],
    "original_description": null
  }

  Input: "canvas wall print", dimensions=[1.0, 0.7, 0.01]
  Output:
  {
    "items": [{
      "description": "canvas wall print",
      "short_name": "wall_print",
      "dimensions": [1.0, 0.7, 0.01],
      "object_type": "WALL_MOUNTED",
      "strategies": ["thin_covering"],
      "thin_covering_type": "single_image"
    }],
    "original_description": null
  }

  Input: "dining table", dimensions=[1.5, 0.9, 0.75]
  Output:
  {
    "items": [],
    "original_description": "dining table",
    "error": "Request is for floor furniture, not a wall-mounted item."
  }
  </examples>

  Request: {{ description }}
  Dimensions: {{ dimensions }}

  Return your response as a JSON object matching the output_schema.
